<html ng-app="cocos" ng-cloak>
    <head>
        <title>About BTC</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="/css/application.css">
    </head>
<body>
    <div class="enter log-in" id="content" ng-controller="signinController">
        <header>
            <!-- <a class="logo" href="/"><img alt="Logo mark.0b14965b" src="https://dbd6j53uzcole.cloudfront.net/assets/images/website/logo-mark.0b14965b.png"></a> -->
            <h2>欢迎回来</h2>
            <h5> :-)</h5></header>
        <main id="sessions-new">
            <form accept-charset="UTF-8"  class="auth-form" id="new_user" method="post">
                <div style="display:none">
                    <input type="hidden" id="token" value="#crsftoken#">
                </div>
                <fieldset>
                    <input autofocus="autofocus" ng-model="email" name="email" placeholder="邮箱地址" type="email">
                    <input name="password"  ng-model="password" placeholder="密码" type="password">
                    <input name="commit" type="submit" value="登录" ng-click="submit()">
                    <div class="remember">
                        <input checked="checked" type="checkbox" value="1">
                        <label class="checkbox-label" for="user_remember_me">记住密码</label><a href="/user/forgot" style="float: right">忘记密码?</a></div>
                </fieldset>
            </form>
        </main>
        <footer><span>没有账号? <a href="/user/signup">免费注册</a></span></footer>
    </div>
    <script src="/js/angular.js"></script>
    <script>

    var csrfconfig = {headers:{"X-Csrf-Token": document.getElementById("token").value}};

    angular.module("cocos",[]).controller("signinController",function($scope, $http){

        
        $scope.submit = function(){
            var data = {email: $scope.email, password: $scope.password};
            $http.post("/user/login", data, csrfconfig).success(function(data){
                
                if(data.status == 1){
                    alert(data.msg);
                }else{
                    location.href="/chat/home";
                }

            });
        };


    });
    </script>
</body>
